<p-dataView #dv filterBy="contractId" [value]="contracts" [paginator]="true" paginatorPosition="both" [rows]="8">
  <p-header>
    <div class="ui-helper-clearfix">
      <div class="ui-g">
        <div class="ui-g-12 ui-md-4">
          <button pButton type="button" label="新增" icon="pi pi-plus" (click)="addBtnOnClick()"></button>
        </div>
        <div class="ui-g-6 ui-md-4 filter-container" style="text-align:center">
          <div style="position:relative">
            <input type="search" pInputText placeholder="请输入合同编号搜索" (keyup)="dv.filter($event.target.value)">
          </div>
        </div>
        <div class="ui-g-6 ui-md-4" style="text-align:right">
          <p-dataViewLayoutOptions></p-dataViewLayoutOptions>
        </div>
      </div>
    </div>
  </p-header>
  <ng-template let-contract pTemplate="listItem">
    <div class="ui-g list" style="border-bottom: 1px solid #d9d9d9;display: flex;justify-content: space-between;">
      <div class="ui-g-12 contract-details">
        <div class="ui-g" style="display:flex;flex-direction:column;">
          <div class="four-Twenty_seven">
            <p>合同编号</p>
            <p>合同名称</p>
            <p>再保公司</p>
            <p>合同类型</p>
            <p>操作</p>
          </div>
          <div class="four-Twenty_seven">
            <p><b>{{contract.contractId}}</b></p>
            <p><b>{{contract.contractName}}</b></p>
            <p><b>{{contract.companyName}}</b></p>
            <p><b>{{contract.contractTypeName}}</b></p>
            <div class="ui-g-12 ui-md-3 search-icon">
              <button pButton type="button" icon="pi pi-ellipsis-h" (click)="selectContract(contract)"></button>
              <button pButton type="button" icon="pi pi-pencil" (click)="modifyContract(contract)"></button>
              <button pButton type="button" class="ui-button-danger" icon="pi pi-trash"
                (click)="delete($event, contract)"></button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
  <ng-template let-contract pTemplate="gridItem">
    <div style="padding:.5em" class="ui-g-12 ui-md-3">
      <p-panel [header]="contract.contractId" [style]="{'text-align':'left'}">
        <div class="contract-detail">
          <div class="ui-n-3">
            <p> 合同名称：</p>
            <p>{{contract.contractName}}</p>
          </div>
          <div class="ui-n-3">
            <p>合同类型：</p>
            <p>{{ contract.contractType}}</p>
          </div>
          <div class="ui-n-3">
            <p>再保公司：</p>
            <p>{{ contract.companyName}}</p>
          </div>
        </div>
        <div class="button">
          <button pButton type="button" icon="pi pi-ellipsis-h" (click)="selectContract(contract)"></button>
          <button pButton type="button" icon="pi pi-pencil" (click)="modifyContract(contract)"></button>
          <button pButton type="button" class="ui-button-danger" icon="pi pi-trash"
            (click)="delete($event, contract)"></button>
        </div>
      </p-panel>
    </div>
  </ng-template>
</p-dataView>

<p-dialog header="合同详细信息" [(visible)]="displayDialog" [responsive]="true" showEffect="fade" [modal]="true"
  [style]="{width: 'auto'}" (onAfterHide)="onDialogHide()">
  <div class="ui-g four_Twenty-eight" *ngIf="selectedContract">
    <div class="list">
      <span>合同编号:</span>
      <span>{{selectedContract.contractId}}</span>
    </div>
    <div class="list">
      <span>合同名称:</span>
      <span>{{selectedContract.contractName}}</span>
    </div>
    <div class="list">
      <span>再保公司:</span>
      <span>{{selectedContract.companyName}}</span>
    </div>
    <div class="list">
      <span>合同类型:</span>
      <span>{{selectedContract.contractTypeName}}</span>
    </div>
    <div class="list">
      <span>再保险种:</span>
      <span>{{selectedContract.reinsTypeName}}</span>
    </div>
    <div class="list">
      <span>合同状态:</span>
      <span>{{selectedContract.contractStatus}}</span>
    </div>
    <div class="list">
      <span>合同备注:</span>
      <span>{{selectedContract.description}}</span>
    </div>
    <div class="list">
      <span>合同起期:</span>
      <span>{{selectedContract.beginDate}}</span>
    </div>
    <div class="list">
      <span>合同止期:</span>
      <span>{{selectedContract.stopDate}}</span>
    </div>
  </div>
</p-dialog>

<!-- 修改合同 -->
<p-dialog header="修改合同信息" [(visible)]="modifyDialog" [modal]="true" [responsive]="true"
  [style]="{width: 'auto', minWidth: 'auto'}" [minY]="70" [maximizable]="true" [baseZIndex]="10000">
  <div class="ui-g" *ngIf="selectedContract">
    <div [formGroup]="contractForm" class="four_Twenty-eight update">
      <div class="list">
        <p class="main">合同编号</p>
        <input type="text" pInputText formControlName="contractId"
          required="required" title="请输入4位及以上的字符" autofocus="autofocus">
        <p-message severity="error" text="此项必填"
          *ngIf="!contractForm.controls['contractId'].valid&&contractForm.controls['contractId'].dirty">
        </p-message>
      </div>
      <div class="list">
        <p>合同名称</p>
        <input type="text" pInputText formControlName="contractName">
        <p-message severity="error" text="此项必填"
          *ngIf="!contractForm.controls['contractName'].valid&&contractForm.controls['contractName'].dirty">
        </p-message>
      </div>
      <div class="list">
        <p>险种类型</p>
        <p-dropdown formControlName="reinsTypeName" [options]="reinsTypeList" placeholder="请选择险种">
        </p-dropdown>
        <p-message style="position: relative;" severity="error" text="此项必填"
          *ngIf="!contractForm.controls['reinsTypeName'].valid&&contractForm.controls['reinsTypeName'].dirty">
        </p-message>
      </div>
      <!-- <div class="list">
        <p>再保公司</p>
        <p-dropdown formControlName="companyName" [options]="companyList" placeholder="请选择再保公司"></p-dropdown>
        <p-message severity="error" text="此项必填"
          *ngIf="!contractForm.controls['companyName'].valid&&contractForm.controls['companyName'].dirty">
        </p-message>
      </div> -->
      <div class="list">
        <p>分保类型</p>
        <p-dropdown formControlName="contractTypeName" [options]="contractTypeList" placeholder="请选择分保类型"
          (onChange)="contractTypeOnChange()">
        </p-dropdown>
        <p-message severity="error" text="此项必填"
          *ngIf="!contractForm.controls['contractTypeName'].valid&&contractForm.controls['contractTypeName'].dirty">
        </p-message>
      </div>
      <div class="list">
        <p>开始日期</p>
        <p-calendar formControlName="beginDate" yearRange="2000:2019" [yearNavigator]="true">
        </p-calendar>
        <p-message severity="error" text="此项必填"
          *ngIf="!contractForm.controls['beginDate'].valid&&contractForm.controls['beginDate'].dirty">
        </p-message>
      </div>
      <div class="list">
        <p>结束日期</p>
        <p-calendar formControlName="stopDate" yearRange="2000:2030" [yearNavigator]="true">
        </p-calendar>
        <p-message severity="error" text="此项必填"
          *ngIf="!contractForm.controls['stopDate'].valid&&contractForm.controls['stopDate'].dirty">
        </p-message>
      </div>

      <div class="list">
        <p>保险金额</p>
        <input type="text" pInputText formControlName="total">
        <p-message severity="error" text="此项必填"
          *ngIf="!contractForm.controls['total'].valid&&contractForm.controls['total'].dirty">
        </p-message>
      </div>

      <div class="list">
        <p>赔款金额</p>
        <input type="text" pInputText formControlName="pay">
        <p-message severity="error" text="此项必填"
          *ngIf="!contractForm.controls['pay'].valid&&contractForm.controls['pay'].dirty">
        </p-message>
      </div>

      <div class="list">
        <p>保险费用</p>
        <input type="text" pInputText formControlName="insurance_expence">
        <p-message severity="error" text="此项必填"
          *ngIf="!contractForm.controls['insurance_expence'].valid&&contractForm.controls['insurance_expence'].dirty">
        </p-message>
      </div>

      <div class="list" *ngIf="surplus">
        <p>自留额</p>
        <input type="text" pInputText formControlName="retention">
        <p-message severity="error" text="此项必填"
          *ngIf="!contractForm.controls['retention'].valid&&contractForm.controls['retention'].dirty">
        </p-message>
      </div>

      <div class="list" *ngIf="surplus">
        <p>线数</p>
        <input type="text" pInputText formControlName="line_num">
        <p-message severity="error" text="此项必填"
          *ngIf="!contractForm.controls['line_num'].valid&&contractForm.controls['line_num'].dirty">
        </p-message>
      </div>

      <div class="list" *ngIf="quotaAshore">
        <p>自留比例</p>
        <input type="text" pInputText formControlName="retention_ratio">
        <p-message severity="error" text="此项必填"
          *ngIf="!contractForm.controls['retention_ratio'].valid&&contractForm.controls['retention_ratio'].dirty">
        </p-message>
      </div>
      <div class="list" *ngIf="quotaAshore">
        <p>最高限额</p>
        <input type="text" pInputText formControlName="ceiling_top">
        <p-message severity="error" text="此项必填"
          *ngIf="!contractForm.controls['ceiling_top'].valid&&contractForm.controls['ceiling_top'].dirty">
        </p-message>
      </div>
      <div class="list">
        <p>合同备注:</p>
        <textarea formControlName="description" rows="3" cols="100" pInputTextarea></textarea>
      </div>
    </div>
  </div>

  <p-footer>
    <button type="button" pButton icon="pi pi-check" (click)="submitModifyMsg()" label="提交"></button>
    <button type="button" pButton icon="pi pi-close" (click)="modifyDialog=false" label="取消"
      class="ui-button-secondary"></button>
  </p-footer>
</p-dialog>
